<?xml version="1.0" encoding="utf-8"?>
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
</auto-generated>
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="a2f2ab88-4c5c-4125-80d9-5db059393048" Name="Pankha Windows Agent" Language="1033" Codepage="Windows-1252" Version="0.4.15" UpgradeCode="08bb88c1-6d1d-476c-98a0-21019082b4f8" Manufacturer="Pankha Fan Control">
    <Package InstallerVersion="200" Compressed="yes" Platform="x64" SummaryCodepage="Windows-1252" InstallScope="perMachine" Languages="1033" />
    <Media Id="1" Cabinet="Pankha20Windows20Agent.cab" EmbedCab="yes" />

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFiles64Folder" Name="ProgramFiles64Folder">
        <Directory Id="INSTALLDIR" Name="Pankha Fan Control">

          <Component Id="Component.pankha2dagent.exe_2959411416" Guid="a2f2ab88-4c5c-4125-80d9-5db07a55a797" Win64="yes">
            <File Id="pankha2dagent.exe_2959411416" Source="..\publish\win-x64\agent\pankha-agent.exe" />

            <ServiceInstall Id="PankhaAgent" Name="PankhaAgent" DisplayName="Pankha Windows Agent" Description="Monitors hardware sensors and controls fan speeds for the Pankha system" Type="ownProcess" Start="auto" ErrorControl="normal" Account="LocalSystem" Interactive="no" />

            <ServiceControl Id="StopPankhaAgent" Name="PankhaAgent" Stop="both" Wait="yes" />
            <ServiceControl Id="StartPankhaAgent" Name="PankhaAgent" Start="install" Wait="no" />
            <ServiceControl Id="RemovePankhaAgent" Name="PankhaAgent" Remove="uninstall" Wait="yes" />
          </Component>

          <Component Id="Component.pankha2dtray.exe_1108545044" Guid="a2f2ab88-4c5c-4125-80d9-5db0354cb119" Win64="yes">
            <File Id="pankha2dtray.exe_1108545044" Source="..\publish\win-x64\agent\pankha-tray.exe" />
          </Component>

          <Component Id="Component.Configure20Pankha20Agent" Guid="a2f2ab88-4c5c-4125-80d9-5db09aa6b358" Win64="yes">
            <Shortcut Id="INSTALLDIR.Configure20Pankha20Agent" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]pankha-agent.exe" Arguments="--setup" Name="Configure Pankha Agent.lnk" />

            <CreateFolder />
            <RemoveFolder Id="INSTALLDIR" On="uninstall" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.View20Pankha20Agent20Logs" Guid="a2f2ab88-4c5c-4125-80d9-5db083e35eee" Win64="yes">
            <Shortcut Id="INSTALLDIR.View20Pankha20Agent20Logs" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]pankha-agent.exe" Arguments="--logs follow" Name="View Pankha Agent Logs.lnk" />

            <CreateFolder />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Pankha20Agent20Status" Guid="a2f2ab88-4c5c-4125-80d9-5db0c8abeca3" Win64="yes">
            <Shortcut Id="INSTALLDIR.Pankha20Agent20Status" WorkingDirectory="INSTALLDIR" Target="[System64Folder]cmd.exe" Arguments="/K &quot;cd /d &quot;[INSTALLDIR]&quot; &amp;&amp; pankha-agent.exe --status &amp;&amp; pause&quot;" Name="Pankha Agent Status.lnk" />

            <CreateFolder />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Uninstall20Pankha20Agent" Guid="a2f2ab88-4c5c-4125-80d9-5db0be115397" Win64="yes">
            <Shortcut Id="INSTALLDIR.Uninstall20Pankha20Agent" WorkingDirectory="INSTALLDIR" Target="[SystemFolder]msiexec.exe" Arguments="/i [ProductCode] /l*v &quot;[CommonAppDataFolder]Pankha Fan Control\logs\uninstall_full.log&quot;" Name="Uninstall Pankha Agent.lnk" />

            <CreateFolder />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Directory Id="logs" Name="logs">

            <Component Id="Component.logs.EmptyDirectory" Guid="a2f2ab88-4c5c-4125-80d9-5db06b3796e6" KeyPath="yes" Win64="yes">
              <CreateFolder />
              <RemoveFolder Id="logs" On="uninstall" />
            </Component>

          </Directory>
        </Directory>
      </Directory>

      <Directory Id="ProgramMenuFolder" Name="ProgramMenuFolder">
        <Directory Id="Pankha20Windows20Agent_" Name="Pankha Windows Agent">

          <Component Id="Component.Pankha20Tray" Guid="a2f2ab88-4c5c-4125-80d9-5db0e4290ac0" Win64="yes">
            <Shortcut Id="Pankha20Windows20Agent_.Pankha20Tray" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]pankha-tray.exe" Name="Pankha Tray.lnk" />

            <CreateFolder />
            <RemoveFolder Id="Pankha20Windows20Agent_" On="uninstall" />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Configure20Pankha20Agent.1" Guid="a2f2ab88-4c5c-4125-80d9-5db06c3ea200" Win64="yes">
            <Shortcut Id="Pankha20Windows20Agent_.Configure20Pankha20Agent.1" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]pankha-agent.exe" Arguments="--setup" Name="Configure Pankha Agent.lnk" />

            <CreateFolder />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.View20Pankha20Agent20Logs.1" Guid="a2f2ab88-4c5c-4125-80d9-5db04ef0c289" Win64="yes">
            <Shortcut Id="Pankha20Windows20Agent_.View20Pankha20Agent20Logs.1" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]pankha-agent.exe" Arguments="--logs follow" Name="View Pankha Agent Logs.lnk" />

            <CreateFolder />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Pankha20Agent20Status.1" Guid="a2f2ab88-4c5c-4125-80d9-5db03e8ca4a6" Win64="yes">
            <Shortcut Id="Pankha20Windows20Agent_.Pankha20Agent20Status.1" WorkingDirectory="System64Folder" Target="[System64Folder]cmd.exe" Arguments="/K &quot;cd /d &quot;[INSTALLDIR]&quot; &amp;&amp; pankha-agent.exe --status &amp;&amp; pause&quot;" Name="Pankha Agent Status.lnk" />

            <CreateFolder />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

          <Component Id="Component.Uninstall20Pankha20Agent.1" Guid="a2f2ab88-4c5c-4125-80d9-5db0157c19f1" Win64="yes">
            <Shortcut Id="Pankha20Windows20Agent_.Uninstall20Pankha20Agent.1" WorkingDirectory="SystemFolder" Target="[SystemFolder]msiexec.exe" Arguments="/i [ProductCode] /l*v &quot;[CommonAppDataFolder]Pankha Fan Control\logs\uninstall_full.log&quot;" Name="Uninstall Pankha Agent.lnk" />

            <CreateFolder />

            <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
              <RegistryValue Value="0" Type="string" KeyPath="yes" />
            </RegistryKey>
          </Component>

        </Directory>
      </Directory>

      <Directory Id="StartupFolder" Name="StartupFolder">

        <Component Id="Component.Pankha20Tray.1" Guid="a2f2ab88-4c5c-4125-80d9-5db085cd9371" Win64="yes">
          <Shortcut Id="StartupFolder.Pankha20Tray.1" WorkingDirectory="INSTALLDIR" Target="[INSTALLDIR]pankha-tray.exe" Name="Pankha Tray.lnk" />

          <CreateFolder />

          <RegistryKey Root="HKCU" Key="Software\WixSharp\Used">
            <RegistryValue Value="0" Type="string" KeyPath="yes" />
          </RegistryKey>
        </Component>

      </Directory>

      <Component Id="TARGETDIR" Guid="a2f2ab88-4c5c-4125-80d9-5db0ccc8a0bb" KeyPath="yes" Win64="yes">
        <RemoveFolder Id="TARGETDIR" On="uninstall" />
      </Component>

    </Directory>

    <UI />

    <Icon Id="app_icon.ico" SourceFile="..\graphics\icons\pankha_icon_256x256_6-fins.ico" />

    <UI>
      <EmbeddedUI Id="WixSharp_EmbeddedUI_Asm" SourceFile="..\publish\win-x64\installer\WixSharp.UI.CA.dll" />
    </UI>

    <WixVariable Id="WixUIBannerBmp" Value="C:\Users\Anex\AppData\Local\Temp\pankha_banner.bmp" />

    <MajorUpgrade AllowSameVersionUpgrades="yes" DowngradeErrorMessage="A newer version is already installed." Schedule="afterInstallInitialize" />

    <CustomAction Id="Set_WixSharp_EnableUninstallFullUI_Action_Props" Property="WixSharp_EnableUninstallFullUI_Action" Value="MSIEXEC_EXTRA_PARAMETERS=;INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode];ADDLOCAL=[ADDLOCAL];ADDFEATURES=[ADDFEATURES]" />
    <CustomAction Id="WixSharp_EnableUninstallFullUI_Action" BinaryKey="WixSharp_EnableUninstallFullUI_Action_File" DllEntry="WixSharp_EnableUninstallFullUI_Action" Return="ignore" Impersonate="no" Execute="deferred" />
    <CustomAction Id="WixSharp_InitRuntime_Action" BinaryKey="WixSharp_EnableUninstallFullUI_Action_File" DllEntry="WixSharp_InitRuntime_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_CancelRequestHandler_Props" Property="CancelRequestHandler" Value="UpgradeCode=[UpgradeCode];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode];ADDLOCAL=[ADDLOCAL];ADDFEATURES=[ADDFEATURES]" />
    <CustomAction Id="CancelRequestHandler" BinaryKey="WixSharp_EnableUninstallFullUI_Action_File" DllEntry="CancelRequestHandler" Return="check" Impersonate="no" Execute="deferred" />
    <CustomAction Id="WixSharp_BeforeInstall_Action" BinaryKey="WixSharp_EnableUninstallFullUI_Action_File" DllEntry="WixSharp_BeforeInstall_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_WixSharp_AfterInstall_Action_Props" Property="WixSharp_AfterInstall_Action" Value="WixSharp_AfterInstall_Handlers=[WixSharp_AfterInstall_Handlers];WIXSHARP_RUNTIME_DATA=[WIXSHARP_RUNTIME_DATA];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductName=[ProductName];FOUNDPREVIOUSVERSION=[FOUNDPREVIOUSVERSION];UpgradeCode=[UpgradeCode];MsiLogFileLocation=[MsiLogFileLocation];KEEP_CONFIG=[KEEP_CONFIG];RESET_CONFIG=[RESET_CONFIG];KEEP_LOGS=[KEEP_LOGS];Manufacturer=[Manufacturer];AgentExe=[AgentExe];AgentUI=[AgentUI];UPGRADINGPRODUCTCODE=[UPGRADINGPRODUCTCODE];WIX_UPGRADE_DETECTED=[WIX_UPGRADE_DETECTED];PREVIOUSINSTALLDIR=[PREVIOUSINSTALLDIR];PREVIOUSINSTALLDIR=[PREVIOUSINSTALLDIR];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode];ADDLOCAL=[ADDLOCAL];ADDFEATURES=[ADDFEATURES]" />
    <CustomAction Id="WixSharp_AfterInstall_Action" BinaryKey="WixSharp_EnableUninstallFullUI_Action_File" DllEntry="WixSharp_AfterInstall_Action" Return="check" Impersonate="no" Execute="deferred" />

    <Binary Id="WixSharp_EnableUninstallFullUI_Action_File" SourceFile="..\publish\win-x64\installer\WixSharp.CA.dll" />
    <Binary Id="ProductLogo" SourceFile="..\graphics\icons\pankha_icon_256x256_6-fins.ico" />
    <Binary Id="ui_shell_icon" SourceFile="..\graphics\icons\pankha_icon_256x256_6-fins.ico" />
    <Binary Id="WixSharp_UIText" SourceFile="..\publish\win-x64\installer\Pankha Windows Agent.wxl" />
    <Binary Id="WixSharp_LicenceFile" SourceFile="..\publish\win-x64\installer\Pankha Windows Agent.licence.rtf" />
    <Binary Id="WixUI_Bmp_Dialog" SourceFile="..\publish\win-x64\installer\Pankha Windows Agent.dialog_bmp.png" />
    <Binary Id="WixUI_Bmp_Banner" SourceFile="C:\Users\Anex\AppData\Local\Temp\pankha_banner.bmp" />

    <UIRef Id="WixUI_ErrorProgressText" />

    <Property Id="KEEP_CONFIG" Value="1" Secure="yes" />
    <Property Id="RESET_CONFIG" Value="0" Secure="yes" />
    <Property Id="KEEP_LOGS" Value="1" Secure="yes" />
    <Property Id="MSIRESTARTMANAGERCONTROL" Value="Disable" />
    <Property Id="MSIDISABLERMRESTART" Value="1" />
    <Property Id="AgentExe" Value="pankha-agent.exe" />
    <Property Id="AgentUI" Value="pankha-tray.exe" />
    <Property Id="ARPINSTALLLOCATION" Value="[INSTALLDIR]" />
    <Property Id="PREVIOUSINSTALLDIR" Secure="yes" />
    <Property Id="UI_AUTOSCALEMODE" Value="Font" />
    <Property Id="WixSharp_UI_INSTALLDIR" Value="INSTALLDIR" />
    <Property Id="UAC_WARNING" Value="Please wait for UAC prompt to appear.&#xD;&#xA;&#xD;&#xA;If it appears minimized then activate it from the taskbar." />
    <Property Id="WixSharp_InstallDialogs" Value="WixSharp.UI, Version=1.26.0.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.WelcomeDialog&#xA;WixSharp.UI, Version=1.26.0.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.InstallDirDialog&#xA;pankha-agent, Version=0.4.15.0, Culture=neutral, PublicKeyToken=null|Pankha.WixSharpInstaller.ConfigurationDialog&#xA;WixSharp.UI, Version=1.26.0.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.ProgressDialog&#xA;pankha-agent, Version=0.4.15.0, Culture=neutral, PublicKeyToken=null|Pankha.WixSharpInstaller.ConditionalExitDialog" />
    <Property Id="WixSharp_ModifyDialogs" Value="pankha-agent, Version=0.4.15.0, Culture=neutral, PublicKeyToken=null|Pankha.WixSharpInstaller.CustomMaintenanceDialog&#xA;pankha-agent, Version=0.4.15.0, Culture=neutral, PublicKeyToken=null|Pankha.WixSharpInstaller.UninstallConfirmDialog&#xA;WixSharp.UI, Version=1.26.0.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.ProgressDialog&#xA;pankha-agent, Version=0.4.15.0, Culture=neutral, PublicKeyToken=null|Pankha.WixSharpInstaller.ConditionalExitDialog" />
    <Property Id="WixSharp_UIInitialized_Handlers" Value="pankha-agent, Version=0.4.15.0, Culture=neutral, PublicKeyToken=null|Pankha.WixSharpInstaller.Program|Project_UIInitialized" />
    <Property Id="WixSharp_BeforeInstall_Handlers" Value="pankha-agent, Version=0.4.15.0, Culture=neutral, PublicKeyToken=null|Pankha.WixSharpInstaller.Program|OnBeforeInstall" />
    <Property Id="WixSharp_AfterInstall_Handlers" Value="pankha-agent, Version=0.4.15.0, Culture=neutral, PublicKeyToken=null|Pankha.WixSharpInstaller.Program|project_AfterInstall" />
    <Property Id="ARPPRODUCTICON" Value="app_icon.ico" />
    <Property Id="REINSTALLMODE" Value="omus" />

    <Feature Id="Complete" Title="Complete" Absent="allow" Level="1">
      <ComponentRef Id="Component.pankha2dagent.exe_2959411416" />
      <ComponentRef Id="Component.pankha2dtray.exe_1108545044" />
      <ComponentRef Id="Component.Configure20Pankha20Agent" />
      <ComponentRef Id="Component.View20Pankha20Agent20Logs" />
      <ComponentRef Id="Component.Pankha20Agent20Status" />
      <ComponentRef Id="Component.Uninstall20Pankha20Agent" />
      <ComponentRef Id="Component.logs.EmptyDirectory" />
      <ComponentRef Id="Component.Pankha20Tray" />
      <ComponentRef Id="Component.Configure20Pankha20Agent.1" />
      <ComponentRef Id="Component.View20Pankha20Agent20Logs.1" />
      <ComponentRef Id="Component.Pankha20Agent20Status.1" />
      <ComponentRef Id="Component.Uninstall20Pankha20Agent.1" />
      <ComponentRef Id="Component.Pankha20Tray.1" />
      <ComponentRef Id="TARGETDIR" />
    </Feature>

    <InstallExecuteSequence>
      <Custom Action="Set_WixSharp_EnableUninstallFullUI_Action_Props" Before="InstallFinalize" />
      <Custom Action="WixSharp_EnableUninstallFullUI_Action" After="Set_WixSharp_EnableUninstallFullUI_Action_Props"> (NOT Installed) </Custom>
      <Custom Action="WixSharp_InitRuntime_Action" Before="AppSearch"> (1) </Custom>
      <Custom Action="Set_CancelRequestHandler_Props" Before="InstallFinalize" />
      <Custom Action="CancelRequestHandler" After="Set_CancelRequestHandler_Props"> (1) </Custom>
      <Custom Action="WixSharp_BeforeInstall_Action" Before="InstallFiles">1</Custom>
      <Custom Action="Set_WixSharp_AfterInstall_Action_Props" After="InstallFiles" />
      <Custom Action="WixSharp_AfterInstall_Action" After="Set_WixSharp_AfterInstall_Action_Props">1</Custom>
    </InstallExecuteSequence>

  </Product>
</Wix>

